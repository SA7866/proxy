{% extends "store/base.html" %}
{% block title %}Checkout • Proxy{% endblock %}

{% block content %}
  <h1 class="page-title">Delivery Details</h1>

  <!-- If the Django form has errors, show a simple message -->
  {% if form.errors %}
    <div class="card" style="border:1px solid #ffb4b4;">
      <b style="color:#b00020;">Please fix the highlighted fields and try again.</b>
    </div>
  {% endif %}

  <div class="grid" style="grid-template-columns: 1.2fr 0.8fr;">
    <!-- Delivery form -->
    <div class="card">
      <h3>Where should we deliver?</h3>

      <form method="post">
        {% csrf_token %}

        <!-- Using Django form fields  -->
        <p>
          {{ form.full_name }}
          {% if form.full_name.errors %}<span style="color:#b00020;">{{ form.full_name.errors }}</span>{% endif %}
        </p>

        <p>
          {{ form.email }}
          {% if form.email.errors %}<span style="color:#b00020;">{{ form.email.errors }}</span>{% endif %}
        </p>

        <p>
          {{ form.address_line1 }}
          {% if form.address_line1.errors %}<span style="color:#b00020;">{{ form.address_line1.errors }}</span>{% endif %}
        </p>

        <p>
          {{ form.city }}
          {% if form.city.errors %}<span style="color:#b00020;">{{ form.city.errors }}</span>{% endif %}
        </p>

        <p>
          {{ form.postcode }}
          {% if form.postcode.errors %}<span style="color:#b00020;">{{ form.postcode.errors }}</span>{% endif %}
        </p>

        <p>
          {{ form.country }}
          {% if form.country.errors %}<span style="color:#b00020;">{{ form.country.errors }}</span>{% endif %}
        </p>

        <button class="btn" type="submit">Place order</button>
      </form>
    </div>

    <!-- Order summary -->
    <div class="card">
      <h3>Your Order</h3>

      {% for item in items %}
        <p style="margin:8px 0;">
          <b>{{ item.product.name }}</b><br>
          £{{ item.product.price }} × {{ item.qty }}
          <span style="float:right;">£{{ item.subtotal|floatformat:2 }}</span>
        </p>
      {% endfor %}

      <hr style="border:none; border-top:1px solid #eee; margin:12px 0;">

      <p class="price">Total: £{{ total|floatformat:2 }}</p>

      <p class="desc">
        Payment step comes next (safe simulated checkout for the prototype).
      </p>
    </div>
  </div>
{% endblock %}

